(()=>{"use strict";var e={n:n=>{var t=n&&n.__esModule?()=>n.default:()=>n;return e.d(t,{a:t}),t},d:(n,t)=>{for(var c in t)e.o(t,c)&&!e.o(n,c)&&Object.defineProperty(n,c,{enumerable:!0,get:t[c]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n)};const n=window.wp.element,t=window.wp.i18n,c=window.wp.apiFetch;var s=e.n(c);const i=window.wp.components,a=window.wp.primitives,r=window.ReactJSXRuntime,p=(0,r.jsx)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,r.jsx)(a.Path,{d:"M17.3 10.1C17.3 7.60001 15.2 5.70001 12.5 5.70001C10.3 5.70001 8.4 7.10001 7.9 9.00001H7.7C5.7 9.00001 4 10.7 4 12.8C4 14.9 5.7 16.6 7.7 16.6H9.5V15.2H7.7C6.5 15.2 5.5 14.1 5.5 12.9C5.5 11.7 6.5 10.5 7.7 10.5H9L9.3 9.40001C9.7 8.10001 11 7.20001 12.5 7.20001C14.3 7.20001 15.8 8.50001 15.8 10.1V11.4L17.1 11.6C17.9 11.7 18.5 12.5 18.5 13.4C18.5 14.4 17.7 15.2 16.8 15.2H14.5V16.6H16.7C18.5 16.6 19.9 15.1 19.9 13.3C20 11.7 18.8 10.4 17.3 10.1Z M14.1245 14.2426L15.1852 13.182L12.0032 10L8.82007 13.1831L9.88072 14.2438L11.25 12.8745V18H12.75V12.8681L14.1245 14.2426Z"})}),l=(0,r.jsx)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,r.jsx)(a.Path,{fillRule:"evenodd",d:"M11.25 5h1.5v15h-1.5V5zM6 10h1.5v10H6V10zm12 4h-1.5v6H18v-6z",clipRule:"evenodd"})}),o=(0,r.jsx)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,r.jsx)(a.Path,{d:"M18 11.3l-1-1.1-4 4V3h-1.5v11.3L7 10.2l-1 1.1 6.2 5.8 5.8-5.8zm.5 3.7v3.5h-13V15H4v5h16v-5h-1.5z"})}),d=(0,r.jsxs)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[(0,r.jsx)(a.Path,{d:"m19 7.5h-7.628c-.3089-.87389-1.1423-1.5-2.122-1.5-.97966 0-1.81309.62611-2.12197 1.5h-2.12803v1.5h2.12803c.30888.87389 1.14231 1.5 2.12197 1.5.9797 0 1.8131-.62611 2.122-1.5h7.628z"}),(0,r.jsx)(a.Path,{d:"m19 15h-2.128c-.3089-.8739-1.1423-1.5-2.122-1.5s-1.8131.6261-2.122 1.5h-7.628v1.5h7.628c.3089.8739 1.1423 1.5 2.122 1.5s1.8131-.6261 2.122-1.5h2.128z"})]}),h=(0,n.forwardRef)(({icon:e,size:t=24,...c},s)=>(0,n.cloneElement)(e,{width:t,height:t,...c,ref:s}));function x(e){if(!e||"Never"===e)return e;try{return new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}catch{return e}}const _=({title:e,value:n,icon:t,color:c="blue",isDate:s=!1})=>(0,r.jsx)(i.Card,{className:`apprco-stat-widget ${{blue:"apprco-stat-blue",green:"apprco-stat-green",purple:"apprco-stat-purple",red:"apprco-stat-red",orange:"apprco-stat-orange"}[c]}`,children:(0,r.jsx)(i.CardBody,{children:(0,r.jsxs)(i.Flex,{align:"center",justify:"space-between",children:[(0,r.jsxs)(i.FlexBlock,{children:[(0,r.jsx)(i.__experimentalText,{variant:"muted",size:"small",className:"apprco-stat-title",children:e}),(0,r.jsx)("div",{className:"apprco-stat-value",children:s?x(n):n})]}),(0,r.jsx)(i.FlexItem,{children:(0,r.jsx)("div",{className:"apprco-stat-icon",children:(0,r.jsx)(h,{icon:t,size:32})})})]})})}),j=()=>{const[e,c]=(0,n.useState)([]),[a,p]=(0,n.useState)(!0),[l,o]=(0,n.useState)(null);(0,n.useEffect)(()=>{d()},[]);const d=async()=>{try{p(!0);const e=await s()({path:"/apprco/v1/imports/recent?limit=5"});c(e.imports||[]),o(null)}catch(e){o(e.message)}finally{p(!1)}};return a?(0,r.jsx)(i.Card,{children:(0,r.jsx)(i.CardBody,{children:(0,r.jsx)(i.Spinner,{})})}):l?(0,r.jsx)(i.Card,{children:(0,r.jsx)(i.CardBody,{children:(0,r.jsx)(i.Notice,{status:"error",isDismissible:!1,children:l})})}):(0,r.jsxs)(i.Card,{className:"apprco-recent-imports",children:[(0,r.jsx)(i.CardHeader,{children:(0,r.jsx)(i.__experimentalHeading,{level:2,children:(0,t.__)("Recent Imports","apprenticeship-connect")})}),(0,r.jsx)(i.CardBody,{children:0===e.length?(0,r.jsx)(i.__experimentalText,{variant:"muted",children:(0,t.__)('No imports yet. Click "Manual Sync" to start.',"apprenticeship-connect")}):(0,r.jsxs)("table",{className:"widefat striped",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:(0,t.__)("Date","apprenticeship-connect")}),(0,r.jsx)("th",{children:(0,t.__)("Type","apprenticeship-connect")}),(0,r.jsx)("th",{children:(0,t.__)("Fetched","apprenticeship-connect")}),(0,r.jsx)("th",{children:(0,t.__)("Created","apprenticeship-connect")}),(0,r.jsx)("th",{children:(0,t.__)("Updated","apprenticeship-connect")}),(0,r.jsx)("th",{children:(0,t.__)("Errors","apprenticeship-connect")}),(0,r.jsx)("th",{children:(0,t.__)("Status","apprenticeship-connect")})]})}),(0,r.jsx)("tbody",{children:e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:new Date(e.started_at).toLocaleString()}),(0,r.jsx)("td",{children:e.trigger_type}),(0,r.jsx)("td",{children:e.total_fetched}),(0,r.jsx)("td",{children:e.total_created}),(0,r.jsx)("td",{children:e.total_updated}),(0,r.jsx)("td",{className:e.total_errors>0?"apprco-error-count":"",children:e.total_errors}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{className:`apprco-status apprco-status-${e.status}`,children:e.status})})]},e.id))})]})})]})},m=(0,r.jsx)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,r.jsx)(a.Path,{fillRule:"evenodd",d:"M10.289 4.836A1 1 0 0111.275 4h1.306a1 1 0 01.987.836l.244 1.466c.787.26 1.503.679 2.108 1.218l1.393-.522a1 1 0 011.216.437l.653 1.13a1 1 0 01-.23 1.273l-1.148.944a6.025 6.025 0 010 2.435l1.149.946a1 1 0 01.23 1.272l-.653 1.13a1 1 0 01-1.216.437l-1.394-.522c-.605.54-1.32.958-2.108 1.218l-.244 1.466a1 1 0 01-.987.836h-1.306a1 1 0 01-.986-.836l-.244-1.466a5.995 5.995 0 01-2.108-1.218l-1.394.522a1 1 0 01-1.217-.436l-.653-1.131a1 1 0 01.23-1.272l1.149-.946a6.026 6.026 0 010-2.435l-1.148-.944a1 1 0 01-.23-1.272l.653-1.131a1 1 0 011.217-.437l1.393.522a5.994 5.994 0 012.108-1.218l.244-1.466zM14.929 12a3 3 0 11-6 0 3 3 0 016 0z",clipRule:"evenodd"})}),u=(0,r.jsx)(a.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)(a.Path,{d:"M4 4v1.5h16V4H4zm8 8.5h8V11h-8v1.5zM4 20h16v-1.5H4V20zm4-8c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2 2-.9 2-2z"})}),v=({onSync:e,syncing:n})=>(0,r.jsxs)(i.Card,{className:"apprco-quick-actions",children:[(0,r.jsx)(i.CardHeader,{children:(0,r.jsx)(i.__experimentalHeading,{level:2,children:(0,t.__)("Quick Actions","apprenticeship-connect")})}),(0,r.jsx)(i.CardBody,{children:(0,r.jsxs)(i.Flex,{gap:3,wrap:!0,children:[(0,r.jsx)(i.Button,{variant:"secondary",icon:p,onClick:e,isBusy:n,disabled:n,children:(0,t.__)("Manual Sync","apprenticeship-connect")}),(0,r.jsx)(i.Button,{variant:"secondary",icon:m,href:"/wp-admin/admin.php?page=apprco-settings",children:(0,t.__)("Settings","apprenticeship-connect")}),(0,r.jsx)(i.Button,{variant:"secondary",icon:u,href:"/wp-admin/admin.php?page=apprco-import-tasks",children:(0,t.__)("Import Tasks","apprenticeship-connect")}),(0,r.jsx)(i.Button,{variant:"secondary",icon:l,href:"/wp-admin/admin.php?page=apprco-logs",children:(0,t.__)("View Logs","apprenticeship-connect")}),(0,r.jsx)(i.Button,{variant:"secondary",icon:o,href:"/wp-admin/edit.php?post_type=apprco_vacancy",children:(0,t.__)("All Vacancies","apprenticeship-connect")})]})})]}),w=(0,r.jsx)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,r.jsx)(a.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})}),g=(0,r.jsx)(a.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)(a.Path,{d:"M12 4c-4.4 0-8 3.6-8 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8Zm3.8 10.7-1.1 1.1-2.7-2.7-2.7 2.7-1.1-1.1 2.7-2.7-2.7-2.7 1.1-1.1 2.7 2.7 2.7-2.7 1.1 1.1-2.7 2.7 2.7 2.7Z"})}),y=()=>{const[e,c]=(0,n.useState)(!1),[a,p]=(0,n.useState)(null);return(0,r.jsxs)(i.Card,{className:"apprco-api-status",children:[(0,r.jsx)(i.CardHeader,{children:(0,r.jsxs)(i.Flex,{justify:"space-between",align:"center",children:[(0,r.jsx)(i.FlexBlock,{children:(0,r.jsx)(i.__experimentalHeading,{level:2,children:(0,t.__)("API Connection","apprenticeship-connect")})}),(0,r.jsx)(i.FlexItem,{children:(0,r.jsx)(i.Button,{variant:"secondary",onClick:async()=>{c(!0),p(null);try{const e=await s()({path:"/apprco/v1/api/test",method:"POST"});p(e)}catch(e){p({success:!1,error:e.message||(0,t.__)("Connection test failed","apprenticeship-connect")})}finally{c(!1)}},isBusy:e,disabled:e,children:e?(0,t.__)("Testing...","apprenticeship-connect"):(0,t.__)("Test Connection","apprenticeship-connect")})})]})}),(0,r.jsx)(i.CardBody,{children:a?a.success?(0,r.jsx)(i.Notice,{status:"success",isDismissible:!1,children:(0,r.jsxs)(i.Flex,{align:"center",gap:2,children:[(0,r.jsx)(i.FlexItem,{children:(0,r.jsx)(h,{icon:w})}),(0,r.jsxs)(i.FlexBlock,{children:[(0,r.jsx)("strong",{children:(0,t.__)("Connection successful!","apprenticeship-connect")}),(0,r.jsx)("br",{}),a.message&&(0,r.jsx)(i.__experimentalText,{children:a.message}),a.sample_count&&(0,r.jsxs)(i.__experimentalText,{children:[(0,t.__)("Sample data: ","apprenticeship-connect"),a.sample_count," ",(0,t.__)("vacancies","apprenticeship-connect")]})]})]})}):(0,r.jsx)(i.Notice,{status:"error",isDismissible:!1,children:(0,r.jsxs)(i.Flex,{align:"center",gap:2,children:[(0,r.jsx)(i.FlexItem,{children:(0,r.jsx)(h,{icon:g})}),(0,r.jsxs)(i.FlexBlock,{children:[(0,r.jsx)("strong",{children:(0,t.__)("Connection failed","apprenticeship-connect")}),(0,r.jsx)("br",{}),(0,r.jsx)(i.__experimentalText,{children:a.error})]})]})}):(0,r.jsx)(i.__experimentalText,{variant:"muted",children:(0,t.__)('Click "Test Connection" to verify your API credentials.',"apprenticeship-connect")})})]})},C=()=>{const[e,c]=(0,n.useState)(null),[a,h]=(0,n.useState)(!0),[x,m]=(0,n.useState)(null),[u,w]=(0,n.useState)(!1);(0,n.useEffect)(()=>{g()},[]);const g=async()=>{try{h(!0);const e=await s()({path:"/apprco/v1/stats"});c(e),m(null)}catch(e){m(e.message||(0,t.__)("Failed to load stats","apprenticeship-connect"))}finally{h(!1)}},C=async()=>{w(!0),m(null);try{const e=await s()({path:"/apprco/v1/import/manual",method:"POST"});e.success?(alert((0,t.__)("Import started successfully!","apprenticeship-connect")+"\n"+sprintf((0,t.__)("Fetched: %d, Created: %d, Updated: %d","apprenticeship-connect"),e.fetched,e.created,e.updated)),g()):m(e.error||(0,t.__)("Import failed","apprenticeship-connect"))}catch(e){m(e.message||(0,t.__)("Import request failed","apprenticeship-connect"))}finally{w(!1)}};return a?(0,r.jsxs)("div",{className:"apprco-dashboard-loading",children:[(0,r.jsx)(i.Spinner,{}),(0,r.jsx)(i.__experimentalText,{children:(0,t.__)("Loading dashboard...","apprenticeship-connect")})]}):(0,r.jsxs)("div",{className:"apprco-dashboard",children:[(0,r.jsxs)(i.Flex,{justify:"space-between",align:"center",className:"apprco-dashboard-header",children:[(0,r.jsxs)(i.FlexBlock,{children:[(0,r.jsx)(i.__experimentalHeading,{level:1,children:(0,t.__)("Apprenticeship Connect Dashboard","apprenticeship-connect")}),(0,r.jsx)(i.__experimentalText,{variant:"muted",children:(0,t.__)("Manage your apprenticeship vacancy imports and settings","apprenticeship-connect")})]}),(0,r.jsx)(i.FlexItem,{children:(0,r.jsx)(i.Button,{variant:"primary",icon:p,onClick:C,isBusy:u,disabled:u,children:u?(0,t.__)("Syncing...","apprenticeship-connect"):(0,t.__)("Manual Sync","apprenticeship-connect")})})]}),x&&(0,r.jsx)(i.Notice,{status:"error",isDismissible:!0,onRemove:()=>m(null),children:x}),(0,r.jsx)(v,{onSync:C,syncing:u}),(0,r.jsxs)("div",{className:"apprco-stats-grid",children:[(0,r.jsx)(_,{title:(0,t.__)("Total Vacancies","apprenticeship-connect"),value:e?.total_vacancies||0,icon:l,color:"blue"}),(0,r.jsx)(_,{title:(0,t.__)("Total Imports","apprenticeship-connect"),value:e?.total_imports||0,icon:o,color:"green"}),(0,r.jsx)(_,{title:(0,t.__)("Last Import","apprenticeship-connect"),value:e?.last_import||(0,t.__)("Never","apprenticeship-connect"),icon:p,color:"purple",isDate:!0}),(0,r.jsx)(_,{title:(0,t.__)("API Status","apprenticeship-connect"),value:e?.api_configured?(0,t.__)("Configured","apprenticeship-connect"):(0,t.__)("Not Configured","apprenticeship-connect"),icon:d,color:e?.api_configured?"green":"red"})]}),(0,r.jsx)(y,{}),(0,r.jsx)(j,{}),(0,r.jsxs)(i.Card,{children:[(0,r.jsx)(i.CardHeader,{children:(0,r.jsx)(i.__experimentalHeading,{level:2,children:(0,t.__)("Getting Started","apprenticeship-connect")})}),(0,r.jsx)(i.CardBody,{children:(0,r.jsxs)("ol",{children:[(0,r.jsxs)("li",{children:[(0,t.__)("Configure your API credentials in","apprenticeship-connect")," ",(0,r.jsx)("a",{href:"/wp-admin/admin.php?page=apprco-settings",children:(0,t.__)("Settings","apprenticeship-connect")})]}),(0,r.jsx)("li",{children:(0,t.__)('Click "Manual Sync" to import vacancies',"apprenticeship-connect")}),(0,r.jsxs)("li",{children:[(0,t.__)("Set up scheduled imports in","apprenticeship-connect")," ",(0,r.jsx)("a",{href:"/wp-admin/admin.php?page=apprco-import-tasks",children:(0,t.__)("Import Tasks","apprenticeship-connect")})]}),(0,r.jsxs)("li",{children:[(0,t.__)("View imported vacancies on","apprenticeship-connect")," ",(0,r.jsx)("a",{href:"/wp-admin/edit.php?post_type=apprco_vacancy",children:(0,t.__)("Vacancies page","apprenticeship-connect")})]})]})})]})]})};document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("apprco-dashboard-root");e&&(0,n.render)((0,r.jsx)(C,{}),e)})})();