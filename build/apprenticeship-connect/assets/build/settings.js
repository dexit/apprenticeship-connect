(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,n=window.wp.i18n,a=window.wp.apiFetch;var i=e.n(a);const s=window.wp.components,c=window.ReactJSXRuntime,p=({settings:e,updateSetting:t,onReset:a})=>(0,c.jsxs)("div",{className:"apprco-settings-category",children:[(0,c.jsxs)("div",{className:"apprco-settings-category-header",children:[(0,c.jsx)("h3",{children:(0,n.__)("API Configuration","apprenticeship-connect")}),(0,c.jsx)(s.Button,{variant:"tertiary",isDestructive:!0,onClick:a,children:(0,n.__)("Reset to Defaults","apprenticeship-connect")})]}),(0,c.jsx)(s.__experimentalText,{variant:"muted",children:(0,n.__)("Configure connection to the UK Government Apprenticeships API.","apprenticeship-connect")}),(0,c.jsx)(s.__experimentalSpacer,{marginY:4}),(0,c.jsx)(s.TextControl,{label:(0,n.__)("API Base URL","apprenticeship-connect"),value:e.base_url,onChange:e=>t("base_url",e),help:(0,n.__)("The base URL for the API endpoint.","apprenticeship-connect"),type:"url"}),(0,c.jsx)(s.TextControl,{label:(0,n.__)("Subscription Key","apprenticeship-connect"),value:e.subscription_key,onChange:e=>t("subscription_key",e),help:(0,n.__)("Your API subscription key (Ocp-Apim-Subscription-Key).","apprenticeship-connect"),type:"password"}),(0,c.jsx)(s.TextControl,{label:(0,n.__)("UKPRN (Optional)","apprenticeship-connect"),value:e.ukprn,onChange:e=>t("ukprn",e),help:(0,n.__)("Filter vacancies by UK Provider Reference Number.","apprenticeship-connect")}),(0,c.jsx)(s.TextControl,{label:(0,n.__)("API Version","apprenticeship-connect"),value:e.version,onChange:e=>t("version",e),help:(0,n.__)("API version header (X-Version).","apprenticeship-connect")}),(0,c.jsx)(s.TextControl,{label:(0,n.__)("Request Timeout (seconds)","apprenticeship-connect"),value:e.timeout,onChange:e=>t("timeout",parseInt(e,10)),help:(0,n.__)("Maximum time to wait for API response (10-300 seconds).","apprenticeship-connect"),type:"number",min:10,max:300}),(0,c.jsx)(s.TextControl,{label:(0,n.__)("Max Retries","apprenticeship-connect"),value:e.retry_max,onChange:e=>t("retry_max",parseInt(e,10)),help:(0,n.__)("Number of retry attempts for failed requests (0-10).","apprenticeship-connect"),type:"number",min:0,max:10}),(0,c.jsx)(s.TextControl,{label:(0,n.__)("Retry Delay (seconds)","apprenticeship-connect"),value:e.retry_delay,onChange:e=>t("retry_delay",parseInt(e,10)),help:(0,n.__)("Delay between retry attempts.","apprenticeship-connect"),type:"number",min:1,max:60})]}),o=({settings:e,updateSetting:t,onReset:a})=>(0,c.jsxs)("div",{className:"apprco-settings-category",children:[(0,c.jsxs)("div",{className:"apprco-settings-category-header",children:[(0,c.jsx)("h3",{children:(0,n.__)("Import Settings","apprenticeship-connect")}),(0,c.jsx)(s.Button,{variant:"tertiary",isDestructive:!0,onClick:a,children:(0,n.__)("Reset to Defaults","apprenticeship-connect")})]}),(0,c.jsx)(s.__experimentalText,{variant:"muted",children:(0,n.__)("Configure how vacancies are imported and processed.","apprenticeship-connect")}),(0,c.jsx)(s.__experimentalSpacer,{marginY:4}),(0,c.jsx)(s.TextControl,{label:(0,n.__)("Batch Size","apprenticeship-connect"),value:e.batch_size,onChange:e=>t("batch_size",parseInt(e,10)),help:(0,n.__)("Number of items to fetch per API request (1-1000).","apprenticeship-connect"),type:"number",min:1,max:1e3}),(0,c.jsx)(s.TextControl,{label:(0,n.__)("Max Pages","apprenticeship-connect"),value:e.max_pages,onChange:e=>t("max_pages",parseInt(e,10)),help:(0,n.__)("Maximum number of pages to fetch per import (1-1000).","apprenticeship-connect"),type:"number",min:1,max:1e3}),(0,c.jsx)(s.TextControl,{label:(0,n.__)("Rate Limit Delay (ms)","apprenticeship-connect"),value:e.rate_limit_delay,onChange:e=>t("rate_limit_delay",parseInt(e,10)),help:(0,n.__)("Delay between API requests to avoid rate limiting.","apprenticeship-connect"),type:"number",min:0,max:5e3}),(0,c.jsx)(s.SelectControl,{label:(0,n.__)("Duplicate Action","apprenticeship-connect"),value:e.duplicate_action,onChange:e=>t("duplicate_action",e),options:[{label:(0,n.__)("Update existing","apprenticeship-connect"),value:"update"},{label:(0,n.__)("Skip duplicates","apprenticeship-connect"),value:"skip"},{label:(0,n.__)("Create new (duplicates allowed)","apprenticeship-connect"),value:"create"}],help:(0,n.__)("How to handle vacancies that already exist.","apprenticeship-connect")}),(0,c.jsx)(s.SelectControl,{label:(0,n.__)("Post Status","apprenticeship-connect"),value:e.post_status,onChange:e=>t("post_status",e),options:[{label:(0,n.__)("Published","apprenticeship-connect"),value:"publish"},{label:(0,n.__)("Draft","apprenticeship-connect"),value:"draft"},{label:(0,n.__)("Pending Review","apprenticeship-connect"),value:"pending"}],help:(0,n.__)("Status for imported vacancies.","apprenticeship-connect")}),(0,c.jsx)(s.ToggleControl,{label:(0,n.__)("Delete Expired Vacancies","apprenticeship-connect"),checked:e.delete_expired,onChange:e=>t("delete_expired",e),help:(0,n.__)("Automatically delete vacancies that are no longer in the API.","apprenticeship-connect")}),e.delete_expired&&(0,c.jsx)(s.TextControl,{label:(0,n.__)("Expire After (days)","apprenticeship-connect"),value:e.expire_after_days,onChange:e=>t("expire_after_days",parseInt(e,10)),help:(0,n.__)("Delete vacancies not updated in this many days (1-365).","apprenticeship-connect"),type:"number",min:1,max:365})]}),r=({settings:e,updateSetting:t,onReset:a})=>(0,c.jsxs)("div",{className:"apprco-settings-category",children:[(0,c.jsxs)("div",{className:"apprco-settings-category-header",children:[(0,c.jsx)("h3",{children:(0,n.__)("Scheduling","apprenticeship-connect")}),(0,c.jsx)(s.Button,{variant:"tertiary",isDestructive:!0,onClick:a,children:(0,n.__)("Reset to Defaults","apprenticeship-connect")})]}),(0,c.jsx)(s.__experimentalText,{variant:"muted",children:(0,n.__)("Configure automated import scheduling.","apprenticeship-connect")}),(0,c.jsx)(s.__experimentalSpacer,{marginY:4}),(0,c.jsx)(s.ToggleControl,{label:(0,n.__)("Enable Scheduled Imports","apprenticeship-connect"),checked:e.enabled,onChange:e=>t("enabled",e),help:(0,n.__)("Run imports automatically on a schedule.","apprenticeship-connect")}),e.enabled&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.SelectControl,{label:(0,n.__)("Frequency","apprenticeship-connect"),value:e.frequency,onChange:e=>t("frequency",e),options:[{label:(0,n.__)("Hourly","apprenticeship-connect"),value:"hourly"},{label:(0,n.__)("Twice Daily","apprenticeship-connect"),value:"twicedaily"},{label:(0,n.__)("Daily","apprenticeship-connect"),value:"daily"},{label:(0,n.__)("Weekly","apprenticeship-connect"),value:"weekly"}],help:(0,n.__)("How often to run automatic imports.","apprenticeship-connect")}),(0,c.jsx)(s.TextControl,{label:(0,n.__)("Schedule Time","apprenticeship-connect"),value:e.time,onChange:e=>t("time",e),help:(0,n.__)("Time of day to run imports (HH:MM format, 24-hour).","apprenticeship-connect"),type:"time"}),(0,c.jsx)(s.ToggleControl,{label:(0,n.__)("Use Action Scheduler","apprenticeship-connect"),checked:e.use_action_scheduler,onChange:e=>t("use_action_scheduler",e),help:(0,n.__)("Use Action Scheduler if available (recommended). Falls back to WP-Cron if disabled or not available.","apprenticeship-connect")})]})]}),l=({settings:e,updateSetting:t,onReset:a})=>(0,c.jsxs)("div",{className:"apprco-settings-category",children:[(0,c.jsxs)("div",{className:"apprco-settings-category-header",children:[(0,c.jsx)("h3",{children:(0,n.__)("Display Options","apprenticeship-connect")}),(0,c.jsx)(s.Button,{variant:"tertiary",isDestructive:!0,onClick:a,children:(0,n.__)("Reset to Defaults","apprenticeship-connect")})]}),(0,c.jsx)(s.__experimentalText,{variant:"muted",children:(0,n.__)("Configure how vacancies are displayed on the frontend.","apprenticeship-connect")}),(0,c.jsx)(s.__experimentalSpacer,{marginY:4}),(0,c.jsx)(s.TextControl,{label:(0,n.__)("Items Per Page","apprenticeship-connect"),value:e.items_per_page,onChange:e=>t("items_per_page",parseInt(e,10)),help:(0,n.__)("Number of vacancies to show per page (1-100).","apprenticeship-connect"),type:"number",min:1,max:100}),(0,c.jsx)(s.ToggleControl,{label:(0,n.__)("Show Employer Name","apprenticeship-connect"),checked:e.show_employer,onChange:e=>t("show_employer",e)}),(0,c.jsx)(s.ToggleControl,{label:(0,n.__)("Show Location","apprenticeship-connect"),checked:e.show_location,onChange:e=>t("show_location",e)}),(0,c.jsx)(s.ToggleControl,{label:(0,n.__)("Show Salary","apprenticeship-connect"),checked:e.show_salary,onChange:e=>t("show_salary",e)}),(0,c.jsx)(s.ToggleControl,{label:(0,n.__)("Show Closing Date","apprenticeship-connect"),checked:e.show_closing_date,onChange:e=>t("show_closing_date",e)}),(0,c.jsx)(s.ToggleControl,{label:(0,n.__)("Show Apply Button","apprenticeship-connect"),checked:e.show_apply_button,onChange:e=>t("show_apply_button",e)}),(0,c.jsx)(s.TextControl,{label:(0,n.__)("Date Format","apprenticeship-connect"),value:e.date_format,onChange:e=>t("date_format",e),help:(0,n.__)('PHP date format for displaying dates (e.g., F j, Y for "January 1, 2024"). See PHP date() documentation.',"apprenticeship-connect")})]}),h=({settings:e,updateSetting:t,onReset:a})=>(0,c.jsxs)("div",{className:"apprco-settings-category",children:[(0,c.jsxs)("div",{className:"apprco-settings-category-header",children:[(0,c.jsx)("h3",{children:(0,n.__)("Advanced Settings","apprenticeship-connect")}),(0,c.jsx)(s.Button,{variant:"tertiary",isDestructive:!0,onClick:a,children:(0,n.__)("Reset to Defaults","apprenticeship-connect")})]}),(0,c.jsx)(s.__experimentalText,{variant:"muted",children:(0,n.__)("Advanced options for power users. Change with caution.","apprenticeship-connect")}),(0,c.jsx)(s.__experimentalSpacer,{marginY:4}),(0,c.jsx)(s.ToggleControl,{label:(0,n.__)("Enable Geocoding","apprenticeship-connect"),checked:e.enable_geocoding,onChange:e=>t("enable_geocoding",e),help:(0,n.__)("Automatically geocode locations using OpenStreetMap Nominatim.","apprenticeship-connect")}),(0,c.jsx)(s.ToggleControl,{label:(0,n.__)("Enable Employer Database","apprenticeship-connect"),checked:e.enable_employers,onChange:e=>t("enable_employers",e),help:(0,n.__)("Store employer information in separate database table.","apprenticeship-connect")}),(0,c.jsx)(s.ToggleControl,{label:(0,n.__)("Enable Detailed Logging","apprenticeship-connect"),checked:e.enable_logging,onChange:e=>t("enable_logging",e),help:(0,n.__)("Log all import activity for debugging and monitoring.","apprenticeship-connect")}),e.enable_logging&&(0,c.jsx)(s.TextControl,{label:(0,n.__)("Log Retention (days)","apprenticeship-connect"),value:e.log_retention_days,onChange:e=>t("log_retention_days",parseInt(e,10)),help:(0,n.__)("Delete logs older than this many days (1-365).","apprenticeship-connect"),type:"number",min:1,max:365}),(0,c.jsx)(s.ToggleControl,{label:(0,n.__)("Debug Mode","apprenticeship-connect"),checked:e.debug_mode,onChange:e=>t("debug_mode",e),help:(0,n.__)("Enable verbose logging and error output. Use for troubleshooting only.","apprenticeship-connect")})]}),_=()=>{const[e,a]=(0,t.useState)(null),[_,d]=(0,t.useState)(null),[u,g]=(0,t.useState)(!0),[m,x]=(0,t.useState)(!1),[y,b]=(0,t.useState)(null),[v,j]=(0,t.useState)(null);(0,t.useEffect)(()=>{C()},[]);const C=async()=>{try{g(!0);const e=await i()({path:"/apprco/v1/settings"});a(e.settings),d(e.defaults),b(null)}catch(e){b(e.message||(0,n.__)("Failed to load settings","apprenticeship-connect"))}finally{g(!1)}},f=t=>{confirm((0,n.__)("Are you sure you want to reset this category to defaults?","apprenticeship-connect"))&&(a({...e,[t]:{..._[t]}}),j((0,n.__)('Category reset to defaults. Click "Save Settings" to apply.',"apprenticeship-connect")))},S=(t,n,i)=>{a({...e,[t]:{...e[t],[n]:i}})};if(u)return(0,c.jsx)("div",{className:"apprco-settings-loading",children:(0,c.jsx)(s.Spinner,{})});const w=[{name:"api",title:(0,n.__)("API","apprenticeship-connect"),className:"apprco-tab-api"},{name:"import",title:(0,n.__)("Import","apprenticeship-connect"),className:"apprco-tab-import"},{name:"schedule",title:(0,n.__)("Schedule","apprenticeship-connect"),className:"apprco-tab-schedule"},{name:"display",title:(0,n.__)("Display","apprenticeship-connect"),className:"apprco-tab-display"},{name:"advanced",title:(0,n.__)("Advanced","apprenticeship-connect"),className:"apprco-tab-advanced"}];return(0,c.jsxs)("div",{className:"apprco-settings",children:[(0,c.jsx)("div",{className:"apprco-settings-header",children:(0,c.jsx)(s.__experimentalHeading,{level:1,children:(0,n.__)("Plugin Settings","apprenticeship-connect")})}),y&&(0,c.jsx)(s.Notice,{status:"error",isDismissible:!0,onRemove:()=>b(null),children:y}),v&&(0,c.jsx)(s.Notice,{status:"success",isDismissible:!0,onRemove:()=>j(null),children:v}),(0,c.jsx)(s.Card,{children:(0,c.jsx)(s.CardBody,{children:(0,c.jsx)(s.TabPanel,{className:"apprco-settings-tabs",tabs:w,children:t=>(0,c.jsxs)("div",{className:"apprco-settings-tab-content",children:["api"===t.name&&(0,c.jsx)(p,{settings:e.api,updateSetting:(e,t)=>S("api",e,t),onReset:()=>f("api")}),"import"===t.name&&(0,c.jsx)(o,{settings:e.import,updateSetting:(e,t)=>S("import",e,t),onReset:()=>f("import")}),"schedule"===t.name&&(0,c.jsx)(r,{settings:e.schedule,updateSetting:(e,t)=>S("schedule",e,t),onReset:()=>f("schedule")}),"display"===t.name&&(0,c.jsx)(l,{settings:e.display,updateSetting:(e,t)=>S("display",e,t),onReset:()=>f("display")}),"advanced"===t.name&&(0,c.jsx)(h,{settings:e.advanced,updateSetting:(e,t)=>S("advanced",e,t),onReset:()=>f("advanced")})]})})})}),(0,c.jsx)("div",{className:"apprco-settings-footer",children:(0,c.jsx)(s.Button,{variant:"primary",onClick:async()=>{x(!0),b(null),j(null);try{const t=await i()({path:"/apprco/v1/settings",method:"POST",data:e});t.success?(j((0,n.__)("Settings saved successfully!","apprenticeship-connect")),a(t.settings)):b(t.errors?t.errors.join(", "):(0,n.__)("Failed to save settings","apprenticeship-connect"))}catch(e){b(e.message||(0,n.__)("Save request failed","apprenticeship-connect"))}finally{x(!1)}},isBusy:m,disabled:m,children:m?(0,n.__)("Saving...","apprenticeship-connect"):(0,n.__)("Save Settings","apprenticeship-connect")})})]})};document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("apprco-settings-root");e&&(0,t.render)((0,c.jsx)(_,{}),e)})})();